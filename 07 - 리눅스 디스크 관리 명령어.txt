디스크 관리 명령어

1. df 명령어

- 현재 파일 시스템의 총 사용률을 확인하는 명령어

df -h

각각 사이즈와 사용한 공간, 남은 공간 등을 확인할 수 있다.

하둡을 설치해서 이용하려면 공간이 많이 필요하기 때문에,

root의 용량을 미리미리 확인해두자.

나 같은 경우는 처음에 약 40GB로 만들어서 아직 많이 남아있다.

 
2. du 명령어

- 현재 파일/디렉토리의 디스크 사용량을 표시하는 명령어

텍스트 파일들의 크기 확인하기

du *.txt

그냥 du 만 쓰면, 모든 파일의 크기가 나오니 조심하자. (엄청 많음)

du -c *.txt

-c 옵션을 주면, 마지막에 총합도 표시해준다

du -ch *.txt

-ch 옵션은 단위까지도 표시해준다.


3. sar 명령어

작업하다가 리눅스 서버가 너무 느려서 작업이 진행이 잘 안될 때

디스크의 사용률을 확인하는 명령어

sar 2 10
- 2초 간격으로 10번 측정하겠다

설명 :

%user 부분을 집중적으로 보면 된다.

리눅스 서버에 부하가 심한 작업을 수행하면

%user 부분의 사용률이 100에 가깝게 올라간다.

 
부하를 심한 작업 예시

1. 악성 SQL 수행

2. 무한 루프

무한 루프를 실행하는 python 문을 만들고,

다른 터미널 창을 하나 더 띄워서

sar 명령어로 사용률을 확인해보자.

간단한 loop문이지만, 사용률이 70%대를 유지하고 있다.

 
# 나머지 컬럼 소개

%user : 일반 유저가 사용하는 disk i/o

%nice : CPU를 양보하는 친절도 -> 너무 높으면, 내 작업이 느려진다.

%system : system이 사용하는 disk i/o

%iowait : i/o를 일으키면서 얼마나 대기하는지

%idle : 작업을 안하고 있는 idle 한 상태

%steal : 다른 프로세서의 자원을 얼마나 뺏고 있는지


내가 만약 리눅스 쉘 프로그램을 만들고 돌린 뒤

회의를 가거나, 퇴근을 해서

내가 돌린 쉘 프로그램이 시스템에 부하를 일으키고 있었는지 확인할 수 없다면?

-> sar 명령어로 수행한 결과를 text 파일로 생성되게 한다.

sar 1 10 >> sar_20210105.txt

한 뒤 나중에 확인

sar 1 10 >> sar_20210105.txt

 

한 뒤 나중에 확인